import{r as s,bE as Te,bF as t}from"./vendor-3b0eb66e.js";import{R as Q,G as ye,V as L,u as d,S as be,Q as Ae,E as Pe,A as je,a as m,b as we,c as Ve,d as Oe,e as Re,r as S,i as D,T as Ne,g as M,f as Ie,h as Ge}from"./index-21dc70bb.js";import{p as Ee,m as Ue,D as Be,T as q,n as Fe,o as Qe,l as g}from"./fluentui-react-cc049b91.js";import"./fluentui-icons-cc979dd7.js";const Le="_askContainer_1tfd8_1",De="_askTopSection_1tfd8_15",Me="_askBottomSection_1tfd8_29",qe="_askTitle_1tfd8_49",He="_askQuestionInput_1tfd8_77",ze="_askAnswerContainer_1tfd8_91",Je="_askAnalysisPanel_1tfd8_105",Ke="_askSettingsSeparator_1tfd8_115",We="_settingsButton_1tfd8_123",n={askContainer:Le,askTopSection:De,askBottomSection:Me,askTitle:qe,askQuestionInput:He,askAnswerContainer:ze,askAnalysisPanel:Je,askSettingsSeparator:Ke,settingsButton:We};function Xe(){const[T,k]=s.useState(!1),[h,H]=s.useState(""),[y,Ye]=s.useState(""),[b,Ze]=s.useState(""),[A,z]=s.useState(.3),[J,P]=s.useState(Q.Hybrid),[j,K]=s.useState(3),[C,w]=s.useState(!0),[V,W]=s.useState(!1),[l,X]=s.useState(!1),[O,Y]=s.useState(ye.TextAndImages),[R,Z]=s.useState(""),[$,ee]=s.useState(""),[te,se]=s.useState([L.Embedding,L.ImageEmbedding]),[N,ae]=s.useState(!1),[I,ne]=s.useState(!1),[G,oe]=s.useState(!1),[ie,re]=s.useState(!1),[le,ce]=s.useState(!1),f=s.useRef(""),[x,E]=s.useState(!1),[c,U]=s.useState(),[o,ue]=s.useState(),[B,F]=s.useState(),[u,r]=s.useState(void 0),i=d?Te().instance:void 0,pe=async()=>{const e=i?await M(i):void 0;Ie(e).then(a=>{oe(a.showGPT4VOptions),w(a.showSemanticRankerOption),re(a.showSemanticRankerOption),ce(a.showVectorOption),a.showVectorOption||P(Q.Text)})};s.useEffect(()=>{pe()},[]);const _=async e=>{f.current=e,c&&U(void 0),E(!0),F(void 0),r(void 0);const a=i?await M(i):void 0;try{const p={messages:[{content:e,role:"user"}],context:{overrides:{prompt_template:h.length===0?void 0:h,prompt_template_prefix:y.length===0?void 0:y,prompt_template_suffix:b.length===0?void 0:b,exclude_category:R.length===0?void 0:R,top:j,temperature:A,retrieval_mode:J,semantic_ranker:C,semantic_captions:V,use_oid_security_filter:N,use_groups_security_filter:I,vector_fields:te,use_gpt4v:l,gpt4v_input:O}},session_state:o?o.choices[0].session_state:null},ve=await Ge(p,a);ue(ve)}catch(p){U(p)}finally{E(!1)}},de=(e,a)=>{H(a||"")},me=(e,a,p)=>{z(e)},Se=(e,a)=>{K(parseInt(a||"3"))},ge=(e,a)=>{w(!!a)},ke=(e,a)=>{W(!!a)},he=(e,a)=>{Z(a||"")},Ce=e=>{_(e),ee(e)},fe=e=>{B===e&&u===m.CitationTab?r(void 0):(F(e),r(m.CitationTab))},v=e=>{r(u===e?void 0:e)},xe=(e,a)=>{ae(!!a)},_e=(e,a)=>{ne(!!a)};return t.jsxs("div",{className:n.askContainer,children:[t.jsxs("div",{className:n.askTopSection,children:[t.jsx(be,{className:n.settingsButton,onClick:()=>k(!T)}),t.jsx("h1",{className:n.askTitle,children:"Ask your data"}),t.jsx("div",{className:n.askQuestionInput,children:t.jsx(Ae,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:x,initQuestion:$,onSend:e=>_(e)})})]}),t.jsxs("div",{className:n.askBottomSection,children:[x&&t.jsx(Ee,{label:"Generating answer"}),!f.current&&t.jsx(Pe,{onExampleClicked:Ce,useGPT4V:l}),!x&&o&&!c&&t.jsx("div",{className:n.askAnswerContainer,children:t.jsx(je,{answer:o,isStreaming:!1,onCitationClicked:e=>fe(e),onThoughtProcessClicked:()=>v(m.ThoughtProcessTab),onSupportingContentClicked:()=>v(m.SupportingContentTab)})}),c?t.jsx("div",{className:n.askAnswerContainer,children:t.jsx(we,{error:c.toString(),onRetry:()=>_(f.current)})}):null,u&&o&&t.jsx(Ve,{className:n.askAnalysisPanel,activeCitation:B,onActiveTabChanged:e=>v(e),citationHeight:"600px",answer:o,activeTab:u})]}),t.jsxs(Ue,{headerText:"Configure answer generation",isOpen:T,isBlocking:!1,onDismiss:()=>k(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>t.jsx(Be,{onClick:()=>k(!1),children:"Close"}),isFooterAtBottom:!0,children:[t.jsx(q,{className:n.askSettingsSeparator,defaultValue:h,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:de}),t.jsx(Fe,{className:n.chatSettingsSeparator,label:"Temperature",min:0,max:1,step:.1,defaultValue:A,onChange:me,showValue:!0,snapToStep:!0}),t.jsx(Qe,{className:n.askSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:j.toString(),onChange:Se}),t.jsx(q,{className:n.askSettingsSeparator,label:"Exclude category",onChange:he}),ie&&t.jsx(g,{className:n.askSettingsSeparator,checked:C,label:"Use semantic ranker for retrieval",onChange:ge}),t.jsx(g,{className:n.askSettingsSeparator,checked:V,label:"Use query-contextual summaries instead of whole documents",onChange:ke,disabled:!C}),G&&t.jsx(Oe,{gpt4vInputs:O,isUseGPT4V:l,updateUseGPT4V:e=>{X(e)},updateGPT4VInputs:e=>Y(e)}),le&&t.jsx(Re,{showImageOptions:l&&G,updateVectorFields:e=>se(e),updateRetrievalMode:e=>P(e)}),d&&t.jsx(g,{className:n.askSettingsSeparator,checked:N||S,label:"Use oid security filter",disabled:!D(i)||S,onChange:xe}),d&&t.jsx(g,{className:n.askSettingsSeparator,checked:I||S,label:"Use groups security filter",disabled:!D(i)||S,onChange:_e}),d&&t.jsx(Ne,{})]})]})}Xe.displayName="Ask";export{Xe as Component};
//# sourceMappingURL=Ask-1f321492.js.map
